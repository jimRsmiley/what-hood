CREATE TABLE user_polygon (id INT NOT NULL, neighborhood_id INT NOT NULL, region_id INT NOT NULL, whathood_user_id INT NOT NULL, date_time_added VARCHAR(255) NOT NULL, polygon geometry(Polygon) NOT NULL, is_deleted BOOLEAN DEFAULT NULL, PRIMARY KEY(id));
CREATE INDEX IDX_9FA93F18803BB24B ON user_polygon (neighborhood_id);
CREATE INDEX IDX_9FA93F1898260155 ON user_polygon (region_id);
CREATE INDEX IDX_9FA93F185219EBCC ON user_polygon (whathood_user_id);
COMMENT ON COLUMN user_polygon.polygon IS '(DC2Type:polygon)';
CREATE TABLE up_np (up_id INT NOT NULL, np_id INT NOT NULL, PRIMARY KEY(up_id, np_id));
CREATE INDEX IDX_50B466A652F241C ON up_np (up_id);
CREATE INDEX IDX_50B466A6121F828F ON up_np (np_id);
CREATE TABLE neighborhood (id INT NOT NULL, region_id INT NOT NULL, name VARCHAR(255) NOT NULL, no_build_border BOOLEAN DEFAULT NULL, date_time_added VARCHAR(255) NOT NULL, PRIMARY KEY(id));
CREATE INDEX IDX_FEF1E9EE98260155 ON neighborhood (region_id);
CREATE UNIQUE INDEX name_region_idx ON neighborhood (name, region_id);
CREATE TABLE region (id INT NOT NULL, name VARCHAR(255) NOT NULL, PRIMARY KEY(id));
CREATE UNIQUE INDEX region_name_idx ON region (name);
CREATE TABLE whathood_user (id INT NOT NULL, ip_address VARCHAR(255) NOT NULL, PRIMARY KEY(id));
CREATE UNIQUE INDEX UNIQ_9E2AFB1622FFD58C ON whathood_user (ip_address);
CREATE TABLE neighborhood_polygon (id INT NOT NULL, neighborhood_id INT NOT NULL, geom geometry NOT NULL, created_at TIMESTAMP(0) WITH TIME ZONE NOT NULL, PRIMARY KEY(id));
CREATE INDEX IDX_9A443078803BB24B ON neighborhood_polygon (neighborhood_id);
COMMENT ON COLUMN neighborhood_polygon.geom IS '(DC2Type:geometry)';
CREATE TABLE users (id INT NOT NULL, username VARCHAR(255) DEFAULT NULL, email VARCHAR(255) NOT NULL, displayName VARCHAR(50) DEFAULT NULL, password VARCHAR(128) NOT NULL, state INT NOT NULL, PRIMARY KEY(id));
CREATE UNIQUE INDEX UNIQ_1483A5E9F85E0677 ON users (username);
CREATE UNIQUE INDEX UNIQ_1483A5E9E7927C74 ON users (email);
CREATE TABLE users_roles (user_id INT NOT NULL, role_id INT NOT NULL, PRIMARY KEY(user_id, role_id));
CREATE INDEX IDX_51498A8EA76ED395 ON users_roles (user_id);
CREATE INDEX IDX_51498A8ED60322AC ON users_roles (role_id);
CREATE TABLE role (id INT NOT NULL, parent_id INT DEFAULT NULL, roleId VARCHAR(255) DEFAULT NULL, PRIMARY KEY(id));
CREATE UNIQUE INDEX UNIQ_57698A6AB8C2FD88 ON role (roleId);
CREATE INDEX IDX_57698A6A727ACA70 ON role (parent_id);
CREATE SEQUENCE user_polygon_id_seq INCREMENT BY 1 MINVALUE 1 START 1;
CREATE SEQUENCE neighborhood_id_seq INCREMENT BY 1 MINVALUE 1 START 1;
CREATE SEQUENCE region_id_seq INCREMENT BY 1 MINVALUE 1 START 1;
CREATE SEQUENCE whathood_user_id_seq INCREMENT BY 1 MINVALUE 1 START 1;
CREATE SEQUENCE neighborhood_polygon_id_seq INCREMENT BY 1 MINVALUE 1 START 1;
CREATE SEQUENCE users_id_seq INCREMENT BY 1 MINVALUE 1 START 1;
CREATE SEQUENCE role_id_seq INCREMENT BY 1 MINVALUE 1 START 1;
ALTER TABLE user_polygon ADD CONSTRAINT FK_9FA93F18803BB24B FOREIGN KEY (neighborhood_id) REFERENCES neighborhood (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE user_polygon ADD CONSTRAINT FK_9FA93F1898260155 FOREIGN KEY (region_id) REFERENCES region (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE user_polygon ADD CONSTRAINT FK_9FA93F185219EBCC FOREIGN KEY (whathood_user_id) REFERENCES whathood_user (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE up_np ADD CONSTRAINT FK_50B466A652F241C FOREIGN KEY (up_id) REFERENCES user_polygon (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE up_np ADD CONSTRAINT FK_50B466A6121F828F FOREIGN KEY (np_id) REFERENCES neighborhood_polygon (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE neighborhood ADD CONSTRAINT FK_FEF1E9EE98260155 FOREIGN KEY (region_id) REFERENCES region (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE neighborhood_polygon ADD CONSTRAINT FK_9A443078803BB24B FOREIGN KEY (neighborhood_id) REFERENCES neighborhood (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE users_roles ADD CONSTRAINT FK_51498A8EA76ED395 FOREIGN KEY (user_id) REFERENCES users (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE users_roles ADD CONSTRAINT FK_51498A8ED60322AC FOREIGN KEY (role_id) REFERENCES role (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE role ADD CONSTRAINT FK_57698A6A727ACA70 FOREIGN KEY (parent_id) REFERENCES role (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
